-- ARENA - Fix Schema and Insert 20 Spanish Proposals
-- Step 1: First update schema to make description nullable (it's deprecated)
-- Step 2: Then insert the 20 Spanish proposals

-- STEP 1: Update schema (make description nullable since we use summary+body now)
ALTER TABLE proposals ALTER COLUMN description DROP NOT NULL;

-- STEP 2: Insert 20 Spanish proposals
INSERT INTO proposals (id, title, summary, body, description, geom, layer, category, tags, status, author_id, created_at, updated_at) VALUES
('prop-1', 'Parque Comunitario Av. del Libertador', 'Transformar el terreno baldío en un espacio verde con juegos infantiles y áreas de descanso', 'Propuesta para convertir el terreno abandonado en Av. del Libertador en un parque comunitario vibrante con juegos infantiles, senderos para caminar y espacios verdes para que los residentes disfruten. Incluye iluminación LED, bancos ecológicos y áreas de picnic.', 'Propuesta para convertir el terreno abandonado en Av. del Libertador en un parque comunitario vibrante con juegos infantiles, senderos para caminar y espacios verdes para que los residentes disfruten. Incluye iluminación LED, bancos ecológicos y áreas de picnic.', '{"type":"Point","coordinates":[-58.46,-34.545]}'::jsonb, 'meso', 'green', ARRAY['parque', 'espacio verde', 'recreación'], 'published', 'demo', NOW(), NOW()),

('prop-2', 'Ciclovía Protegida Lugones-Libertador', 'Expandir red de ciclovías con 8km de carriles protegidos conectando zonas residenciales', 'Ampliar la red de ciclovías existente agregando 8 kilómetros de carriles protegidos que conecten áreas residenciales con distritos comerciales y estaciones de transporte público. Incluye señalización, estaciones de bicicletas públicas y cruces seguros.', 'Ampliar la red de ciclovías existente agregando 8 kilómetros de carriles protegidos que conecten áreas residenciales con distritos comerciales y estaciones de transporte público. Incluye señalización, estaciones de bicicletas públicas y cruces seguros.', '{"type":"Point","coordinates":[-58.458,-34.547]}'::jsonb, 'macro', 'transport', ARRAY['movilidad', 'sustentabilidad', 'ciclovía'], 'published', 'demo', NOW(), NOW()),

('prop-3', 'Renovación Biblioteca Municipal Núñez', 'Modernizar biblioteca con tecnología actualizada y espacios de estudio ampliados', 'Renovar y modernizar la biblioteca municipal de Núñez con tecnología actualizada, espacios de estudio ampliados, sala de lectura infantil y características mejoradas de accesibilidad para todos los miembros de la comunidad. WiFi gratuito y aire acondicionado.', 'Renovar y modernizar la biblioteca municipal de Núñez con tecnología actualizada, espacios de estudio ampliados, sala de lectura infantil y características mejoradas de accesibilidad para todos los miembros de la comunidad. WiFi gratuito y aire acondicionado.', '{"type":"Point","coordinates":[-58.462,-34.543]}'::jsonb, 'micro', 'social', ARRAY['cultura', 'educación', 'accesibilidad'], 'published', 'demo', NOW(), NOW()),

('prop-4', 'Huertas Urbanas Comunitarias', 'Crear 6 huertas urbanas para producción local de alimentos y educación ambiental', 'Crear 6 huertas urbanas comunitarias en terrenos municipales para promover la producción local de alimentos, educación ambiental y espacios de reunión vecinal. Incluye sistema de riego por goteo, compostaje y talleres mensuales de agricultura urbana.', 'Crear 6 huertas urbanas comunitarias en terrenos municipales para promover la producción local de alimentos, educación ambiental y espacios de reunión vecinal. Incluye sistema de riego por goteo, compostaje y talleres mensuales de agricultura urbana.', '{"type":"Point","coordinates":[-58.464,-34.544]}'::jsonb, 'meso', 'green', ARRAY['sustentabilidad', 'comunidad', 'agricultura urbana'], 'published', 'demo', NOW(), NOW()),

('prop-5', 'Iluminación LED en Espacios Públicos', 'Reemplazar luminarias antiguas con LEDs eficientes para mejorar seguridad y reducir costos', 'Reemplazar la iluminación pública antigua con luminarias LED de alta eficiencia energética para mejorar la seguridad pública, reducir costos de energía y minimizar la contaminación lumínica. Proyecto piloto en 50 cuadras del barrio.', 'Reemplazar la iluminación pública antigua con luminarias LED de alta eficiencia energética para mejorar la seguridad pública, reducir costos de energía y minimizar la contaminación lumínica. Proyecto piloto en 50 cuadras del barrio.', '{"type":"Point","coordinates":[-58.459,-34.546]}'::jsonb, 'meso', 'infrastructure', ARRAY['seguridad', 'eficiencia energética', 'iluminación'], 'published', 'demo', NOW(), NOW()),

('prop-6', 'Plaza Inclusiva con Juegos Adaptados', 'Diseñar plaza con juegos inclusivos para niños con diferentes capacidades', 'Crear una plaza inclusiva en la intersección de Av. Congreso y Crisólogo Larralde con juegos adaptados para niños con discapacidad motriz, sensorial y cognitiva. Incluye rampas, pisos de goma reciclada, columpios adaptados y señalización en braille.', 'Crear una plaza inclusiva en la intersección de Av. Congreso y Crisólogo Larralde con juegos adaptados para niños con discapacidad motriz, sensorial y cognitiva. Incluye rampas, pisos de goma reciclada, columpios adaptados y señalización en braille.', '{"type":"Point","coordinates":[-58.457,-34.542]}'::jsonb, 'micro', 'social', ARRAY['inclusión', 'accesibilidad', 'infancia'], 'published', 'demo', NOW(), NOW()),

('prop-7', 'Corredor Verde Cantilo', 'Forestación y embellecimiento de Av. Cantilo con 200 árboles nativos', 'Proyecto de forestación urbana en Av. Cantilo con plantación de 200 árboles nativos (tipa, jacarandá, ceibo), ampliación de veredas, incorporación de bicicleteros y mobiliario urbano sustentable. Reducirá la temperatura ambiente en verano.', 'Proyecto de forestación urbana en Av. Cantilo con plantación de 200 árboles nativos (tipa, jacarandá, ceibo), ampliación de veredas, incorporación de bicicleteros y mobiliario urbano sustentable. Reducirá la temperatura ambiente en verano.', '{"type":"Point","coordinates":[-58.461,-34.548]}'::jsonb, 'meso', 'green', ARRAY['forestación', 'medio ambiente', 'espacio público'], 'published', 'demo', NOW(), NOW()),

('prop-8', 'Centro Cultural Barrial Multidisciplinario', 'Convertir galpón abandonado en centro cultural con talleres y espacios de arte', 'Recuperar galpón ferroviario abandonado para crear un centro cultural multidisciplinario con salas de teatro, talleres de arte, biblioteca popular, sala de ensayo musical y café cultural. Gestión comunitaria con programación gratuita.', 'Recuperar galpón ferroviario abandonado para crear un centro cultural multidisciplinario con salas de teatro, talleres de arte, biblioteca popular, sala de ensayo musical y café cultural. Gestión comunitaria con programación gratuita.', '{"type":"Point","coordinates":[-58.463,-34.541]}'::jsonb, 'micro', 'social', ARRAY['cultura', 'arte', 'comunidad'], 'published', 'demo', NOW(), NOW()),

('prop-9', 'Pasos Peatonales Seguros Escuela N°12', 'Instalar señalización luminosa y reductores de velocidad en zona escolar', 'Mejorar seguridad vial en el entorno de la Escuela Primaria N°12 con señalización luminosa inteligente, reductores de velocidad (lomos de burro), ensanchamiento de veredas en cruces y pintura vial reflectante. Prioridad peatonal en horarios de entrada/salida.', 'Mejorar seguridad vial en el entorno de la Escuela Primaria N°12 con señalización luminosa inteligente, reductores de velocidad (lomos de burro), ensanchamiento de veredas en cruces y pintura vial reflectante. Prioridad peatonal en horarios de entrada/salida.', '{"type":"Point","coordinates":[-58.465,-34.545]}'::jsonb, 'micro', 'transport', ARRAY['seguridad vial', 'educación', 'infancia'], 'published', 'demo', NOW(), NOW()),

('prop-10', 'Mercado Agroecológico de Productores Locales', 'Feria semanal de productores locales con productos orgánicos y sustentables', 'Crear mercado agroecológico permanente en Plaza Balcarce con puestos de productores locales, alimentos orgánicos, artesanías sustentables y food trucks con gastronomía de cercanía. Funciona sábados y domingos con música en vivo.', 'Crear mercado agroecológico permanente en Plaza Balcarce con puestos de productores locales, alimentos orgánicos, artesanías sustentables y food trucks con gastronomía de cercanía. Funciona sábados y domingos con música en vivo.', '{"type":"Point","coordinates":[-58.458,-34.549]}'::jsonb, 'micro', 'social', ARRAY['comercio local', 'sustentabilidad', 'economía circular'], 'published', 'demo', NOW(), NOW()),

('prop-11', 'Mirador Panorámico Costanera Norte', 'Construcción de mirador elevado con vistas al Río de la Plata', 'Construir mirador panorámico de madera y acero en la Costanera Norte con plataforma elevada a 8 metros, telescopios públicos, cartelería informativa sobre biodiversidad del río, y área de descanso con sombra. Acceso universal por rampa.', 'Construir mirador panorámico de madera y acero en la Costanera Norte con plataforma elevada a 8 metros, telescopios públicos, cartelería informativa sobre biodiversidad del río, y área de descanso con sombra. Acceso universal por rampa.', '{"type":"Point","coordinates":[-58.456,-34.540]}'::jsonb, 'micro', 'green', ARRAY['turismo', 'espacio público', 'naturaleza'], 'published', 'demo', NOW(), NOW()),

('prop-12', 'Viviendas Sociales Sustentables', 'Proyecto de 80 viviendas sociales con tecnologías verdes y eficiencia energética', 'Desarrollo habitacional de 80 viviendas sociales con paneles solares, sistemas de recolección de agua de lluvia, aislación térmica premium, calefacción por bomba de calor y techos verdes. Diseño bioclimático con orientación norte y ventilación cruzada.', 'Desarrollo habitacional de 80 viviendas sociales con paneles solares, sistemas de recolección de agua de lluvia, aislación térmica premium, calefacción por bomba de calor y techos verdes. Diseño bioclimático con orientación norte y ventilación cruzada.', '{"type":"Point","coordinates":[-58.467,-34.543]}'::jsonb, 'macro', 'housing', ARRAY['vivienda social', 'sustentabilidad', 'eficiencia energética'], 'published', 'demo', NOW(), NOW()),

('prop-13', 'Calle Compartida Peatonal-Vehicular', 'Rediseño de calle O''Higgins como espacio compartido con prioridad peatonal', 'Transformar calle O''Higgins en "calle compartida" eliminando cordones, usando pavimento único, limitando velocidad a 20km/h, incorporando vegetación, iluminación cálida y mobiliario urbano. Modelo holandés de convivencia peatón-vehículo.', 'Transformar calle O''Higgins en "calle compartida" eliminando cordones, usando pavimento único, limitando velocidad a 20km/h, incorporando vegetación, iluminación cálida y mobiliario urbano. Modelo holandés de convivencia peatón-vehículo.', '{"type":"Point","coordinates":[-58.460,-34.544]}'::jsonb, 'micro', 'transport', ARRAY['movilidad', 'peatonal', 'tránsito calmado'], 'published', 'demo', NOW(), NOW()),

('prop-14', 'Gimnasio Municipal al Aire Libre', 'Instalación de equipamiento deportivo gratuito en Parque Saavedra', 'Montar gimnasio al aire libre en Parque Saavedra con 15 estaciones de ejercicio (barras, paralelas, banco de abdominales, elíptica, etc.), piso de caucho reciclado, pérgola con paneles solares e iluminación nocturna. Clases gratuitas 3 veces por semana.', 'Montar gimnasio al aire libre en Parque Saavedra con 15 estaciones de ejercicio (barras, paralelas, banco de abdominales, elíptica, etc.), piso de caucho reciclado, pérgola con paneles solares e iluminación nocturna. Clases gratuitas 3 veces por semana.', '{"type":"Point","coordinates":[-58.462,-34.547]}'::jsonb, 'micro', 'social', ARRAY['deporte', 'salud', 'espacio público'], 'published', 'demo', NOW(), NOW()),

('prop-15', 'Estación de Compostaje Comunitaria', 'Centro de compostaje barrial para gestión de residuos orgánicos', 'Instalar estación de compostaje comunitaria con 12 bins de compostaje, área de separación de residuos, invernadero demostrativo y espacio educativo. Reducirá 40% de residuos domiciliarios generando compost de calidad para huertas urbanas.', 'Instalar estación de compostaje comunitaria con 12 bins de compostaje, área de separación de residuos, invernadero demostrativo y espacio educativo. Reducirá 40% de residuos domiciliarios generando compost de calidad para huertas urbanas.', '{"type":"Point","coordinates":[-58.464,-34.541]}'::jsonb, 'micro', 'green', ARRAY['compostaje', 'residuos', 'economía circular'], 'published', 'demo', NOW(), NOW()),

('prop-16', 'Paseo Comercial Peatonal Av. Cabildo', 'Peatonalización de 4 cuadras de Av. Cabildo con boulevard y terrazas', 'Peatonalizar 4 cuadras de Av. Cabildo entre Monroe y Juramento creando paseo comercial con boulevard central, pérgolas, jardineras, fuentes de agua, asientos, wifi público y áreas para terrazas gastronómicas. Acceso controlado para servicios.', 'Peatonalizar 4 cuadras de Av. Cabildo entre Monroe y Juramento creando paseo comercial con boulevard central, pérgolas, jardineras, fuentes de agua, asientos, wifi público y áreas para terrazas gastronómicas. Acceso controlado para servicios.', '{"type":"Point","coordinates":[-58.459,-34.542]}'::jsonb, 'meso', 'urban', ARRAY['peatonal', 'comercio', 'espacio público'], 'published', 'demo', NOW(), NOW()),

('prop-17', 'Red de Bebederos Públicos Sustentables', 'Instalación de 25 bebederos con filtro UV para reducir consumo de plástico', 'Instalar red de 25 bebederos públicos con sistema de filtrado UV y refrigeración solar en parques, plazas y paradas de colectivo. Reducirá consumo de botellas plásticas en 50.000 unidades anuales. App móvil mostrará ubicaciones.', 'Instalar red de 25 bebederos públicos con sistema de filtrado UV y refrigeración solar en parques, plazas y paradas de colectivo. Reducirá consumo de botellas plásticas en 50.000 unidades anuales. App móvil mostrará ubicaciones.', '{"type":"Point","coordinates":[-58.461,-34.546]}'::jsonb, 'meso', 'infrastructure', ARRAY['sustentabilidad', 'agua', 'plástico'], 'published', 'demo', NOW(), NOW()),

('prop-18', 'Sendero Ecológico Ribereño', 'Circuito peatonal-ciclista de 3km junto al río con observación de aves', 'Construir sendero ecológico de 3km en la ribera con deck de madera, miradores de avifauna, cartelería interpretativa sobre el ecosistema del Río de la Plata, área de avistaje con binoculares fijos y circuito de running señalizado.', 'Construir sendero ecológico de 3km en la ribera con deck de madera, miradores de avifauna, cartelería interpretativa sobre el ecosistema del Río de la Plata, área de avistaje con binoculares fijos y circuito de running señalizado.', '{"type":"Point","coordinates":[-58.455,-34.539]}'::jsonb, 'meso', 'green', ARRAY['naturaleza', 'ecoturismo', 'biodiversidad'], 'published', 'demo', NOW(), NOW()),

('prop-19', 'Centro de Acopio de Reciclables', 'Punto verde permanente para separación y acopio de materiales reciclables', 'Crear centro de acopio de reciclables con contenedores para papel/cartón, vidrio, plásticos, metales, electrónicos y pilas. Personal capacitado, báscula, prensa compactadora y convenio con cooperativas recuperadoras. Abierto martes a domingo.', 'Crear centro de acopio de reciclables con contenedores para papel/cartón, vidrio, plásticos, metales, electrónicos y pilas. Personal capacitado, báscula, prensa compactadora y convenio con cooperativas recuperadoras. Abierto martes a domingo.', '{"type":"Point","coordinates":[-58.466,-34.548]}'::jsonb, 'micro', 'infrastructure', ARRAY['reciclaje', 'residuos', 'economía circular'], 'published', 'demo', NOW(), NOW()),

('prop-20', 'Skatepark Municipal Hormigón', 'Parque de skate profesional con bowls, rampas y área de street', 'Construir skatepark de hormigón de 1.200m² con bowl profundo, área de street (rieles, escaleras, rampas), snake run, zona principiantes y tribuna. Iluminación LED para uso nocturno. Incluye espacio para BMX y patines en línea.', 'Construir skatepark de hormigón de 1.200m² con bowl profundo, área de street (rieles, escaleras, rampas), snake run, zona principiantes y tribuna. Iluminación LED para uso nocturno. Incluye espacio para BMX y patines en línea.', '{"type":"Point","coordinates":[-58.463,-34.549]}'::jsonb, 'micro', 'social', ARRAY['deporte', 'juventud', 'recreación'], 'published', 'demo', NOW(), NOW())

ON CONFLICT (id) DO UPDATE SET
  title = EXCLUDED.title,
  summary = EXCLUDED.summary,
  body = EXCLUDED.body,
  description = EXCLUDED.description,
  geom = EXCLUDED.geom,
  layer = EXCLUDED.layer,
  category = EXCLUDED.category,
  tags = EXCLUDED.tags,
  status = EXCLUDED.status,
  updated_at = NOW();

-- STEP 3: Verify insert
SELECT COUNT(*) as total_proposals FROM proposals;
SELECT id, title, category, status FROM proposals WHERE id LIKE 'prop-%' ORDER BY id;
